ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3722us (Server=2467302134us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15231us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4136us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5047us (Server=2467309642us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15148us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 34515us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4451us (Server=2467323502us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 14207us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3234us (Server=2467327827us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 13448us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 27655us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4247us (Server=2467339621us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4176us (Server=2467343919us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4835us (Server=2467348245us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 46553us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1317 | BOOT | 0 | 0 | -
8946 | BOOT | 0 | 0 | 0x00007AB4
14105 | BOOT | 0 | 0 | 0x0000C0DE
324169 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
337776 | UNKNOWN | 100 | 8 | 0x00001388
346066 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
357399 | UNKNOWN | 100 | 1 | 0x00000008
369814 | CONTRACT_APPLY | 1 | 0 | 0x00001388
373214 | MEM_ALLOC | 1 | 0 | 0x00000001
375667 | MEM_ALLOC | 1 | 0 | 0x00000001
378041 | MEM_ALLOC | 1 | 0 | 0x00000001
380391 | MEM_ALLOC | 1 | 0 | 0x00000001
385293 | MEM_EXCEED | 1 | 0 | 0x00000014
388035 | STATE_CHANGE | 1 | 0 | 0x00000001
393900 | MEM_FREE | 1 | 0 | 0x00000001
393954 | MEM_FREE | 1 | 0 | 0x00000001
393979 | MEM_FREE | 1 | 0 | 0x00000001
394002 | MEM_FREE | 1 | 0 | 0x00000001
396656 | JOB_SUBMIT | 1 | 0 | 0x00000003
397040 | STEP_START | 1 | 0 | -
412344 | STEP_END | 1 | 0 | 15231us
416209 | BUDGET_EXCEED | 1 | 0 | 0x00003B7F
416975 | STEP_START | 1 | 1 | -
421117 | STEP_END | 1 | 1 | 4136us
423582 | BUDGET_EXCEED | 1 | 1 | 0x00001028
423643 | STEP_START | 1 | 2 | -
438800 | STEP_END | 1 | 2 | 15148us
441299 | BUDGET_EXCEED | 1 | 2 | 0x00003B2C
443853 | JOB_COMPLETE | 1 | 0 | -
456884 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
459419 | MEM_ALLOC | 2 | 1 | 0x00000001
461859 | MEM_ALLOC | 2 | 1 | 0x00000001
466785 | MEM_EXCEED | 2 | 0 | 0x0000000C
469157 | STATE_CHANGE | 2 | 0 | 0x00000001
471748 | MEM_FREE | 2 | 1 | 0x00000001
471775 | MEM_FREE | 2 | 1 | 0x00000001
474244 | JOB_SUBMIT | 2 | 0 | 0x00000002
474254 | STEP_START | 2 | 0 | -
488470 | STEP_END | 2 | 0 | 14207us
491012 | BUDGET_EXCEED | 2 | 0 | 0x0000377F
491028 | STEP_START | 2 | 1 | -
504488 | STEP_END | 2 | 1 | 13448us
507369 | BUDGET_EXCEED | 2 | 1 | 0x00003488
509929 | JOB_COMPLETE | 2 | 0 | -
526748 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
532249 | JOB_SUBMIT | 3 | 0 | 0x00000003
532259 | STEP_START | 3 | 0 | -
547827 | STEP_END | 3 | 0 | 15561us
548018 | STEP_START | 3 | 1 | -
563241 | STEP_END | 3 | 1 | 15216us
563264 | STEP_START | 3 | 2 | -
579047 | STEP_END | 3 | 2 | 15776us
581534 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000007
[kern] Response received.
[kern] Reset OK. Init Blob: 7
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6665us (Server=2467734330us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 18873us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4450us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3504us (Server=2467741824us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 14574us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 37897us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4197us (Server=2467756889us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15311us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5536us (Server=2467762316us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16554us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 31865us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3576us (Server=2467774039us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4520us (Server=2467778393us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4305us (Server=2467782684us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 45538us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1668 | BOOT | 0 | 0 | -
8475 | BOOT | 0 | 0 | 0x00007AB4
11372 | BOOT | 0 | 0 | 0x0000C0DE
316508 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
330922 | UNKNOWN | 100 | 8 | 0x00001388
339108 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
350468 | UNKNOWN | 100 | 1 | 0x00000008
363897 | CONTRACT_APPLY | 1 | 0 | 0x00001388
367080 | MEM_ALLOC | 1 | 0 | 0x00000001
369802 | MEM_ALLOC | 1 | 0 | 0x00000001
372462 | MEM_ALLOC | 1 | 0 | 0x00000001
375105 | MEM_ALLOC | 1 | 0 | 0x00000001
380606 | MEM_EXCEED | 1 | 0 | 0x00000014
383735 | STATE_CHANGE | 1 | 0 | 0x00000001
390346 | MEM_FREE | 1 | 0 | 0x00000001
390402 | MEM_FREE | 1 | 0 | 0x00000001
390426 | MEM_FREE | 1 | 0 | 0x00000001
390450 | MEM_FREE | 1 | 0 | 0x00000001
393412 | JOB_SUBMIT | 1 | 0 | 0x00000003
393790 | STEP_START | 1 | 0 | -
412722 | STEP_END | 1 | 0 | 18873us
416193 | BUDGET_EXCEED | 1 | 0 | 0x000049B9
416672 | STEP_START | 1 | 1 | -
421128 | STEP_END | 1 | 1 | 4450us
423994 | BUDGET_EXCEED | 1 | 1 | 0x00001162
424051 | STEP_START | 1 | 2 | -
438633 | STEP_END | 1 | 2 | 14574us
441504 | BUDGET_EXCEED | 1 | 2 | 0x000038EE
444192 | JOB_COMPLETE | 1 | 0 | -
458446 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
461273 | MEM_ALLOC | 2 | 1 | 0x00000001
463935 | MEM_ALLOC | 2 | 1 | 0x00000001
469288 | MEM_EXCEED | 2 | 0 | 0x0000000C
471895 | STATE_CHANGE | 2 | 0 | 0x00000001
474816 | MEM_FREE | 2 | 1 | 0x00000001
474842 | MEM_FREE | 2 | 1 | 0x00000001
477584 | JOB_SUBMIT | 2 | 0 | 0x00000002
477594 | STEP_START | 2 | 0 | -
492914 | STEP_END | 2 | 0 | 15311us
495753 | BUDGET_EXCEED | 2 | 0 | 0x00003BCF
495768 | STEP_START | 2 | 1 | -
512328 | STEP_END | 2 | 1 | 16554us
515157 | BUDGET_EXCEED | 2 | 1 | 0x000040AA
517662 | JOB_COMPLETE | 2 | 0 | -
534406 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
539882 | JOB_SUBMIT | 3 | 0 | 0x00000003
539892 | STEP_START | 3 | 0 | -
554503 | STEP_END | 3 | 0 | 14603us
554670 | STEP_START | 3 | 1 | -
570327 | STEP_END | 3 | 1 | 15650us
570348 | STEP_START | 3 | 2 | -
585640 | STEP_END | 3 | 2 | 15285us
588156 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6145us (Server=2468209690us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 17237us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4203us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5124us (Server=2468217190us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15182us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 36622us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4383us (Server=2468231094us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 14639us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5176us (Server=2468236431us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16208us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 30847us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6032us (Server=2468248289us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4848us (Server=2468252607us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4549us (Server=2468256979us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 48321us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1985 | BOOT | 0 | 0 | -
11142 | BOOT | 0 | 0 | 0x00007AB4
15728 | BOOT | 0 | 0 | 0x0000C0DE
444778 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
458773 | UNKNOWN | 100 | 8 | 0x00001388
466602 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
476958 | UNKNOWN | 100 | 1 | 0x00000008
489580 | CONTRACT_APPLY | 1 | 0 | 0x00001388
492574 | MEM_ALLOC | 1 | 0 | 0x00000001
495384 | MEM_ALLOC | 1 | 0 | 0x00000001
498021 | MEM_ALLOC | 1 | 0 | 0x00000001
500607 | MEM_ALLOC | 1 | 0 | 0x00000001
505658 | MEM_EXCEED | 1 | 0 | 0x00000014
508618 | STATE_CHANGE | 1 | 0 | 0x00000001
514720 | MEM_FREE | 1 | 0 | 0x00000001
514774 | MEM_FREE | 1 | 0 | 0x00000001
514799 | MEM_FREE | 1 | 0 | 0x00000001
514822 | MEM_FREE | 1 | 0 | 0x00000001
517509 | JOB_SUBMIT | 1 | 0 | 0x00000003
517878 | STEP_START | 1 | 0 | -
535180 | STEP_END | 1 | 0 | 17237us
538611 | BUDGET_EXCEED | 1 | 0 | 0x00004355
539087 | STEP_START | 1 | 1 | -
543296 | STEP_END | 1 | 1 | 4203us
545848 | BUDGET_EXCEED | 1 | 1 | 0x0000106B
545907 | STEP_START | 1 | 2 | -
561099 | STEP_END | 1 | 2 | 15182us
563615 | BUDGET_EXCEED | 1 | 2 | 0x00003B4E
566194 | JOB_COMPLETE | 1 | 0 | -
579578 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
582103 | MEM_ALLOC | 2 | 1 | 0x00000001
584613 | MEM_ALLOC | 2 | 1 | 0x00000001
589489 | MEM_EXCEED | 2 | 0 | 0x0000000C
591909 | STATE_CHANGE | 2 | 0 | 0x00000001
594559 | MEM_FREE | 2 | 1 | 0x00000001
594585 | MEM_FREE | 2 | 1 | 0x00000001
597095 | JOB_SUBMIT | 2 | 0 | 0x00000002
597105 | STEP_START | 2 | 0 | -
611754 | STEP_END | 2 | 0 | 14639us
614346 | BUDGET_EXCEED | 2 | 0 | 0x0000392F
614365 | STEP_START | 2 | 1 | -
630582 | STEP_END | 2 | 1 | 16208us
633590 | BUDGET_EXCEED | 2 | 1 | 0x00003F50
635980 | JOB_COMPLETE | 2 | 0 | -
651902 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
656848 | JOB_SUBMIT | 3 | 0 | 0x00000003
656859 | STEP_START | 3 | 0 | -
673713 | STEP_END | 3 | 0 | 16845us
673917 | STEP_START | 3 | 1 | -
689866 | STEP_END | 3 | 1 | 15941us
689891 | STEP_START | 3 | 2 | -
705433 | STEP_END | 3 | 2 | 15535us
707942 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3129us (Server=2468657013us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 13876us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4174us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6039us (Server=2468664500us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15833us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 33883us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4229us (Server=2468678349us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 14227us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6412us (Server=2468683671us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16438us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 30665us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4867us (Server=2468695500us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3950us (Server=2468699814us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4900us (Server=2468704142us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 46194us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1248 | BOOT | 0 | 0 | -
8053 | BOOT | 0 | 0 | 0x00007AB4
10891 | BOOT | 0 | 0 | 0x0000C0DE
294305 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
307401 | UNKNOWN | 100 | 8 | 0x00001388
314912 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
324794 | UNKNOWN | 100 | 1 | 0x00000008
337108 | CONTRACT_APPLY | 1 | 0 | 0x00001388
340009 | MEM_ALLOC | 1 | 0 | 0x00000001
342468 | MEM_ALLOC | 1 | 0 | 0x00000001
344887 | MEM_ALLOC | 1 | 0 | 0x00000001
347403 | MEM_ALLOC | 1 | 0 | 0x00000001
352424 | MEM_EXCEED | 1 | 0 | 0x00000014
355145 | STATE_CHANGE | 1 | 0 | 0x00000001
360868 | MEM_FREE | 1 | 0 | 0x00000001
360921 | MEM_FREE | 1 | 0 | 0x00000001
360945 | MEM_FREE | 1 | 0 | 0x00000001
360969 | MEM_FREE | 1 | 0 | 0x00000001
363690 | JOB_SUBMIT | 1 | 0 | 0x00000003
364066 | STEP_START | 1 | 0 | -
378001 | STEP_END | 1 | 0 | 13876us
381073 | BUDGET_EXCEED | 1 | 0 | 0x00003634
381535 | STEP_START | 1 | 1 | -
385716 | STEP_END | 1 | 1 | 4174us
388233 | BUDGET_EXCEED | 1 | 1 | 0x0000104E
388285 | STEP_START | 1 | 2 | -
404126 | STEP_END | 1 | 2 | 15833us
406664 | BUDGET_EXCEED | 1 | 2 | 0x00003DD9
409183 | JOB_COMPLETE | 1 | 0 | -
422247 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
424982 | MEM_ALLOC | 2 | 1 | 0x00000001
427423 | MEM_ALLOC | 2 | 1 | 0x00000001
432337 | MEM_EXCEED | 2 | 0 | 0x0000000C
434716 | STATE_CHANGE | 2 | 0 | 0x00000001
437407 | MEM_FREE | 2 | 1 | 0x00000001
437435 | MEM_FREE | 2 | 1 | 0x00000001
439992 | JOB_SUBMIT | 2 | 0 | 0x00000002
440001 | STEP_START | 2 | 0 | -
454237 | STEP_END | 2 | 0 | 14227us
456926 | BUDGET_EXCEED | 2 | 0 | 0x00003793
456940 | STEP_START | 2 | 1 | -
473385 | STEP_END | 2 | 1 | 16438us
475938 | BUDGET_EXCEED | 2 | 1 | 0x00004036
478272 | JOB_COMPLETE | 2 | 0 | -
494800 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
501224 | JOB_SUBMIT | 3 | 0 | 0x00000003
501235 | STEP_START | 3 | 0 | -
517287 | STEP_END | 3 | 0 | 16044us
517463 | STEP_START | 3 | 1 | -
532139 | STEP_END | 3 | 1 | 14669us
532159 | STEP_START | 3 | 2 | -
547647 | STEP_END | 3 | 2 | 15481us
550208 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=2958us (Server=2469087064us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 13960us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4258us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5711us (Server=2469094604us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15567us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 33785us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3201us (Server=2469108477us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 13761us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6346us (Server=2469113820us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16299us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 30060us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3583us (Server=2469124627us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5393us (Server=2469128916us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5419us (Server=2469133212us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 44399us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1233 | BOOT | 0 | 0 | -
8192 | BOOT | 0 | 0 | 0x00007AB4
11522 | BOOT | 0 | 0 | 0x0000C0DE
298730 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
312105 | UNKNOWN | 100 | 8 | 0x00001388
320403 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
330487 | UNKNOWN | 100 | 1 | 0x00000008
342895 | CONTRACT_APPLY | 1 | 0 | 0x00001388
345856 | MEM_ALLOC | 1 | 0 | 0x00000001
348460 | MEM_ALLOC | 1 | 0 | 0x00000001
351402 | MEM_ALLOC | 1 | 0 | 0x00000001
353906 | MEM_ALLOC | 1 | 0 | 0x00000001
359008 | MEM_EXCEED | 1 | 0 | 0x00000014
361843 | STATE_CHANGE | 1 | 0 | 0x00000001
367798 | MEM_FREE | 1 | 0 | 0x00000001
367850 | MEM_FREE | 1 | 0 | 0x00000001
367875 | MEM_FREE | 1 | 0 | 0x00000001
367898 | MEM_FREE | 1 | 0 | 0x00000001
370705 | JOB_SUBMIT | 1 | 0 | 0x00000003
371079 | STEP_START | 1 | 0 | -
385103 | STEP_END | 1 | 0 | 13960us
388406 | BUDGET_EXCEED | 1 | 0 | 0x00003688
388873 | STEP_START | 1 | 1 | -
393138 | STEP_END | 1 | 1 | 4258us
395657 | BUDGET_EXCEED | 1 | 1 | 0x000010A2
395710 | STEP_START | 1 | 2 | -
411284 | STEP_END | 1 | 2 | 15567us
413801 | BUDGET_EXCEED | 1 | 2 | 0x00003CCF
416299 | JOB_COMPLETE | 1 | 0 | -
429653 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
432246 | MEM_ALLOC | 2 | 1 | 0x00000001
434752 | MEM_ALLOC | 2 | 1 | 0x00000001
440095 | MEM_EXCEED | 2 | 0 | 0x0000000C
442466 | STATE_CHANGE | 2 | 0 | 0x00000001
445126 | MEM_FREE | 2 | 1 | 0x00000001
445153 | MEM_FREE | 2 | 1 | 0x00000001
447844 | JOB_SUBMIT | 2 | 0 | 0x00000002
447855 | STEP_START | 2 | 0 | -
461624 | STEP_END | 2 | 0 | 13761us
464230 | BUDGET_EXCEED | 2 | 0 | 0x000035C1
464246 | STEP_START | 2 | 1 | -
480552 | STEP_END | 2 | 1 | 16299us
483087 | BUDGET_EXCEED | 2 | 1 | 0x00003FAB
485499 | JOB_COMPLETE | 2 | 0 | -
500922 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
505926 | JOB_SUBMIT | 3 | 0 | 0x00000003
505936 | STEP_START | 3 | 0 | -
519491 | STEP_END | 3 | 0 | 13549us
519631 | STEP_START | 3 | 1 | -
535058 | STEP_END | 3 | 1 | 15421us
535077 | STEP_START | 3 | 2 | -
550514 | STEP_END | 3 | 2 | 15429us
552883 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3534us (Server=2469525544us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15790us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4158us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4234us (Server=2469532999us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 14242us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 34190us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5798us (Server=2469547855us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16354us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5832us (Server=2469553226us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 15773us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 32127us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3410us (Server=2469563911us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4022us (Server=2469568223us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5014us (Server=2469572551us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 45484us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1207 | BOOT | 0 | 0 | -
8201 | BOOT | 0 | 0 | 0x00007AB4
11155 | BOOT | 0 | 0 | 0x0000C0DE
317342 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
330637 | UNKNOWN | 100 | 8 | 0x00001388
338232 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
348289 | UNKNOWN | 100 | 1 | 0x00000008
361534 | CONTRACT_APPLY | 1 | 0 | 0x00001388
364814 | MEM_ALLOC | 1 | 0 | 0x00000001
367481 | MEM_ALLOC | 1 | 0 | 0x00000001
370207 | MEM_ALLOC | 1 | 0 | 0x00000001
372907 | MEM_ALLOC | 1 | 0 | 0x00000001
378366 | MEM_EXCEED | 1 | 0 | 0x00000014
381502 | STATE_CHANGE | 1 | 0 | 0x00000001
388148 | MEM_FREE | 1 | 0 | 0x00000001
388202 | MEM_FREE | 1 | 0 | 0x00000001
388227 | MEM_FREE | 1 | 0 | 0x00000001
388251 | MEM_FREE | 1 | 0 | 0x00000001
391246 | JOB_SUBMIT | 1 | 0 | 0x00000003
391656 | STEP_START | 1 | 0 | -
407489 | STEP_END | 1 | 0 | 15790us
410582 | BUDGET_EXCEED | 1 | 0 | 0x00003DAE
411052 | STEP_START | 1 | 1 | -
415216 | STEP_END | 1 | 1 | 4158us
417770 | BUDGET_EXCEED | 1 | 1 | 0x0000103E
417829 | STEP_START | 1 | 2 | -
432078 | STEP_END | 1 | 2 | 14242us
434635 | BUDGET_EXCEED | 1 | 2 | 0x000037A2
437120 | JOB_COMPLETE | 1 | 0 | -
451179 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
453929 | MEM_ALLOC | 2 | 1 | 0x00000001
456583 | MEM_ALLOC | 2 | 1 | 0x00000001
461755 | MEM_EXCEED | 2 | 0 | 0x0000000C
464330 | STATE_CHANGE | 2 | 0 | 0x00000001
467313 | MEM_FREE | 2 | 1 | 0x00000001
467340 | MEM_FREE | 2 | 1 | 0x00000001
470088 | JOB_SUBMIT | 2 | 0 | 0x00000002
470097 | STEP_START | 2 | 0 | -
486459 | STEP_END | 2 | 0 | 16354us
489001 | BUDGET_EXCEED | 2 | 0 | 0x00003FE2
489017 | STEP_START | 2 | 1 | -
504794 | STEP_END | 2 | 1 | 15773us
507349 | BUDGET_EXCEED | 2 | 1 | 0x00003D9D
509676 | JOB_COMPLETE | 2 | 0 | -
524794 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
530121 | JOB_SUBMIT | 3 | 0 | 0x00000003
530132 | STEP_START | 3 | 0 | -
544852 | STEP_END | 3 | 0 | 14714us
545012 | STEP_START | 3 | 1 | -
559810 | STEP_END | 3 | 1 | 14793us
559830 | STEP_START | 3 | 2 | -
575812 | STEP_END | 3 | 2 | 15977us
578229 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5134us (Server=2469961496us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16065us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4176us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6107us (Server=2469969005us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 16756us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 36997us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4539us (Server=2469984093us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15476us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5207us (Server=2469989433us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16397us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 31873us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3277us (Server=2470001145us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4612us (Server=2470005511us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4303us (Server=2470009830us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 45021us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
2093 | BOOT | 0 | 0 | -
11595 | BOOT | 0 | 0 | 0x00007AB4
16618 | BOOT | 0 | 0 | 0x0000C0DE
326974 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
340104 | UNKNOWN | 100 | 8 | 0x00001388
347655 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
358190 | UNKNOWN | 100 | 1 | 0x00000008
370598 | CONTRACT_APPLY | 1 | 0 | 0x00001388
373552 | MEM_ALLOC | 1 | 0 | 0x00000001
376079 | MEM_ALLOC | 1 | 0 | 0x00000001
378564 | MEM_ALLOC | 1 | 0 | 0x00000001
381022 | MEM_ALLOC | 1 | 0 | 0x00000001
386018 | MEM_EXCEED | 1 | 0 | 0x00000014
388816 | STATE_CHANGE | 1 | 0 | 0x00000001
394726 | MEM_FREE | 1 | 0 | 0x00000001
394779 | MEM_FREE | 1 | 0 | 0x00000001
394804 | MEM_FREE | 1 | 0 | 0x00000001
394828 | MEM_FREE | 1 | 0 | 0x00000001
397538 | JOB_SUBMIT | 1 | 0 | 0x00000003
397913 | STEP_START | 1 | 0 | -
414036 | STEP_END | 1 | 0 | 16065us
417160 | BUDGET_EXCEED | 1 | 0 | 0x00003EC1
417623 | STEP_START | 1 | 1 | -
421805 | STEP_END | 1 | 1 | 4176us
424382 | BUDGET_EXCEED | 1 | 1 | 0x00001050
424440 | STEP_START | 1 | 2 | -
441203 | STEP_END | 1 | 2 | 16756us
444128 | BUDGET_EXCEED | 1 | 2 | 0x00004174
446823 | JOB_COMPLETE | 1 | 0 | -
461270 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
464170 | MEM_ALLOC | 2 | 1 | 0x00000001
466832 | MEM_ALLOC | 2 | 1 | 0x00000001
472232 | MEM_EXCEED | 2 | 0 | 0x0000000C
474760 | STATE_CHANGE | 2 | 0 | 0x00000001
477538 | MEM_FREE | 2 | 1 | 0x00000001
477565 | MEM_FREE | 2 | 1 | 0x00000001
480219 | JOB_SUBMIT | 2 | 0 | 0x00000002
480230 | STEP_START | 2 | 0 | -
495714 | STEP_END | 2 | 0 | 15476us
498657 | BUDGET_EXCEED | 2 | 0 | 0x00003C74
498671 | STEP_START | 2 | 1 | -
515076 | STEP_END | 2 | 1 | 16397us
518002 | BUDGET_EXCEED | 2 | 1 | 0x0000400D
520506 | JOB_COMPLETE | 2 | 0 | -
537407 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
542829 | JOB_SUBMIT | 3 | 0 | 0x00000003
542839 | STEP_START | 3 | 0 | -
557087 | STEP_END | 3 | 0 | 14240us
557255 | STEP_START | 3 | 1 | -
573040 | STEP_END | 3 | 1 | 15778us
573062 | STEP_START | 3 | 2 | -
588072 | STEP_END | 3 | 2 | 15003us
590506 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 [USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3870us (Server=2470398965us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15986us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4450us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3868us (Server=2470406514us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 14868us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 35304us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4111us (Server=2470421499us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15212us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5750us (Server=2470426993us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16577us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 31789us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4028us (Server=2470438721us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4329us (Server=2470443005us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4406us (Server=2470447375us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 45740us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
2114 | BOOT | 0 | 0 | -
11892 | BOOT | 0 | 0 | 0x00007AB4
16910 | BOOT | 0 | 0 | 0x0000C0DE
330576 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
345199 | UNKNOWN | 100 | 8 | 0x00001388
353559 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
364980 | UNKNOWN | 100 | 1 | 0x00000008
378583 | CONTRACT_APPLY | 1 | 0 | 0x00001388
381806 | MEM_ALLOC | 1 | 0 | 0x00000001
384444 | MEM_ALLOC | 1 | 0 | 0x00000001
387023 | MEM_ALLOC | 1 | 0 | 0x00000001
389709 | MEM_ALLOC | 1 | 0 | 0x00000001
395205 | MEM_EXCEED | 1 | 0 | 0x00000014
398410 | STATE_CHANGE | 1 | 0 | 0x00000001
405070 | MEM_FREE | 1 | 0 | 0x00000001
405124 | MEM_FREE | 1 | 0 | 0x00000001
405148 | MEM_FREE | 1 | 0 | 0x00000001
405171 | MEM_FREE | 1 | 0 | 0x00000001
408081 | JOB_SUBMIT | 1 | 0 | 0x00000003
408459 | STEP_START | 1 | 0 | -
424505 | STEP_END | 1 | 0 | 15986us
428204 | BUDGET_EXCEED | 1 | 0 | 0x00003E72
428693 | STEP_START | 1 | 1 | -
433150 | STEP_END | 1 | 1 | 4450us
435999 | BUDGET_EXCEED | 1 | 1 | 0x00001162
436059 | STEP_START | 1 | 2 | -
450935 | STEP_END | 1 | 2 | 14868us
453881 | BUDGET_EXCEED | 1 | 2 | 0x00003A14
456448 | JOB_COMPLETE | 1 | 0 | -
470920 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
473701 | MEM_ALLOC | 2 | 1 | 0x00000001
476281 | MEM_ALLOC | 2 | 1 | 0x00000001
481550 | MEM_EXCEED | 2 | 0 | 0x0000000C
484088 | STATE_CHANGE | 2 | 0 | 0x00000001
486978 | MEM_FREE | 2 | 1 | 0x00000001
487005 | MEM_FREE | 2 | 1 | 0x00000001
489761 | JOB_SUBMIT | 2 | 0 | 0x00000002
489771 | STEP_START | 2 | 0 | -
504992 | STEP_END | 2 | 0 | 15212us
507824 | BUDGET_EXCEED | 2 | 0 | 0x00003B6C
507839 | STEP_START | 2 | 1 | -
524422 | STEP_END | 2 | 1 | 16577us
527349 | BUDGET_EXCEED | 2 | 1 | 0x000040C1
529768 | JOB_COMPLETE | 2 | 0 | -
546302 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
551917 | JOB_SUBMIT | 3 | 0 | 0x00000003
551929 | STEP_START | 3 | 0 | -
566959 | STEP_END | 3 | 0 | 15023us
567134 | STEP_START | 3 | 1 | -
582617 | STEP_END | 3 | 1 | 15476us
582641 | STEP_START | 3 | 2 | -
597888 | STEP_END | 3 | 2 | 15241us
600401 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3645us (Server=2470845704us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 14627us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4257us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5568us (Server=2470853256us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15868us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 34752us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6387us (Server=2470868234us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16760us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6472us (Server=2470873629us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16699us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 33459us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6589us (Server=2470885474us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5141us (Server=2470889792us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5116us (Server=2470894132us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 47915us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1202 | BOOT | 0 | 0 | -
8064 | BOOT | 0 | 0 | 0x00007AB4
11023 | BOOT | 0 | 0 | 0x0000C0DE
326025 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
339124 | UNKNOWN | 100 | 8 | 0x00001388
346736 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
357510 | UNKNOWN | 100 | 1 | 0x00000008
370020 | CONTRACT_APPLY | 1 | 0 | 0x00001388
372999 | MEM_ALLOC | 1 | 0 | 0x00000001
375533 | MEM_ALLOC | 1 | 0 | 0x00000001
378015 | MEM_ALLOC | 1 | 0 | 0x00000001
380533 | MEM_ALLOC | 1 | 0 | 0x00000001
385835 | MEM_EXCEED | 1 | 0 | 0x00000014
388801 | STATE_CHANGE | 1 | 0 | 0x00000001
395019 | MEM_FREE | 1 | 0 | 0x00000001
395076 | MEM_FREE | 1 | 0 | 0x00000001
395101 | MEM_FREE | 1 | 0 | 0x00000001
395125 | MEM_FREE | 1 | 0 | 0x00000001
397878 | JOB_SUBMIT | 1 | 0 | 0x00000003
398249 | STEP_START | 1 | 0 | -
412934 | STEP_END | 1 | 0 | 14627us
416104 | BUDGET_EXCEED | 1 | 0 | 0x00003923
416575 | STEP_START | 1 | 1 | -
420839 | STEP_END | 1 | 1 | 4257us
423608 | BUDGET_EXCEED | 1 | 1 | 0x000010A1
423668 | STEP_START | 1 | 2 | -
439545 | STEP_END | 1 | 2 | 15868us
442230 | BUDGET_EXCEED | 1 | 2 | 0x00003DFC
444820 | JOB_COMPLETE | 1 | 0 | -
458546 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
461197 | MEM_ALLOC | 2 | 1 | 0x00000001
463793 | MEM_ALLOC | 2 | 1 | 0x00000001
468854 | MEM_EXCEED | 2 | 0 | 0x0000000C
471409 | STATE_CHANGE | 2 | 0 | 0x00000001
474176 | MEM_FREE | 2 | 1 | 0x00000001
474203 | MEM_FREE | 2 | 1 | 0x00000001
476789 | JOB_SUBMIT | 2 | 0 | 0x00000002
476798 | STEP_START | 2 | 0 | -
493570 | STEP_END | 2 | 0 | 16760us
496193 | BUDGET_EXCEED | 2 | 0 | 0x00004178
496206 | STEP_START | 2 | 1 | -
512914 | STEP_END | 2 | 1 | 16699us
515486 | BUDGET_EXCEED | 2 | 1 | 0x0000413B
517889 | JOB_COMPLETE | 2 | 0 | -
533509 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
538648 | JOB_SUBMIT | 3 | 0 | 0x00000003
538660 | STEP_START | 3 | 0 | -
555550 | STEP_END | 3 | 0 | 16880us
555748 | STEP_START | 3 | 1 | -
571282 | STEP_END | 3 | 1 | 15528us
571305 | STEP_START | 3 | 2 | -
586820 | STEP_END | 3 | 2 | 15507us
589261 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5890us (Server=2471272856us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16863us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4143us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5997us (Server=2471280389us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15970us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 36976us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4861us (Server=2471294347us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 14723us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=2778us (Server=2471298616us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 12660us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 27383us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3751us (Server=2471309373us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4599us (Server=2471313674us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4604us (Server=2471318038us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 45897us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1226 | BOOT | 0 | 0 | -
8347 | BOOT | 0 | 0 | 0x00007AB4
11632 | BOOT | 0 | 0 | 0x0000C0DE
299399 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
312701 | UNKNOWN | 100 | 8 | 0x00001388
320850 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
330882 | UNKNOWN | 100 | 1 | 0x00000008
343706 | CONTRACT_APPLY | 1 | 0 | 0x00001388
346661 | MEM_ALLOC | 1 | 0 | 0x00000001
349202 | MEM_ALLOC | 1 | 0 | 0x00000001
352198 | MEM_ALLOC | 1 | 0 | 0x00000001
354706 | MEM_ALLOC | 1 | 0 | 0x00000001
359686 | MEM_EXCEED | 1 | 0 | 0x00000014
362442 | STATE_CHANGE | 1 | 0 | 0x00000001
368224 | MEM_FREE | 1 | 0 | 0x00000001
368277 | MEM_FREE | 1 | 0 | 0x00000001
368301 | MEM_FREE | 1 | 0 | 0x00000001
368326 | MEM_FREE | 1 | 0 | 0x00000001
371026 | JOB_SUBMIT | 1 | 0 | 0x00000003
371397 | STEP_START | 1 | 0 | -
388321 | STEP_END | 1 | 0 | 16863us
391368 | BUDGET_EXCEED | 1 | 0 | 0x000041DF
391867 | STEP_START | 1 | 1 | -
396016 | STEP_END | 1 | 1 | 4143us
398533 | BUDGET_EXCEED | 1 | 1 | 0x0000102F
398588 | STEP_START | 1 | 2 | -
414568 | STEP_END | 1 | 2 | 15970us
417104 | BUDGET_EXCEED | 1 | 2 | 0x00003E62
419639 | JOB_COMPLETE | 1 | 0 | -
432688 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
435234 | MEM_ALLOC | 2 | 1 | 0x00000001
437699 | MEM_ALLOC | 2 | 1 | 0x00000001
442559 | MEM_EXCEED | 2 | 0 | 0x0000000C
444977 | STATE_CHANGE | 2 | 0 | 0x00000001
447572 | MEM_FREE | 2 | 1 | 0x00000001
447596 | MEM_FREE | 2 | 1 | 0x00000001
450122 | JOB_SUBMIT | 2 | 0 | 0x00000002
450131 | STEP_START | 2 | 0 | -
464864 | STEP_END | 2 | 0 | 14723us
467380 | BUDGET_EXCEED | 2 | 0 | 0x00003983
467396 | STEP_START | 2 | 1 | -
480065 | STEP_END | 2 | 1 | 12660us
482556 | BUDGET_EXCEED | 2 | 1 | 0x00003174
484893 | JOB_COMPLETE | 2 | 0 | -
500107 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
505099 | JOB_SUBMIT | 3 | 0 | 0x00000003
505112 | STEP_START | 3 | 0 | -
519660 | STEP_END | 3 | 0 | 14539us
519856 | STEP_START | 3 | 1 | -
535562 | STEP_END | 3 | 1 | 15697us
535600 | STEP_START | 3 | 2 | -
551267 | STEP_END | 3 | 2 | 15661us
553640 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5446us (Server=2471727547us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16594us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4285us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5646us (Server=2471735061us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15680us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 36559us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4424us (Server=2471750020us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16116us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5781us (Server=2471755395us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16817us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 32933us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3666us (Server=2471767209us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4685us (Server=2471771481us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5108us (Server=2471775793us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 44871us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1276 | BOOT | 0 | 0 | -
8236 | BOOT | 0 | 0 | 0x00007AB4
11101 | BOOT | 0 | 0 | 0x0000C0DE
311399 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
325526 | UNKNOWN | 100 | 8 | 0x00001388
333560 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
343820 | UNKNOWN | 100 | 1 | 0x00000008
357090 | CONTRACT_APPLY | 1 | 0 | 0x00001388
360499 | MEM_ALLOC | 1 | 0 | 0x00000001
363847 | MEM_ALLOC | 1 | 0 | 0x00000001
366429 | MEM_ALLOC | 1 | 0 | 0x00000001
368886 | MEM_ALLOC | 1 | 0 | 0x00000001
374057 | MEM_EXCEED | 1 | 0 | 0x00000014
377112 | STATE_CHANGE | 1 | 0 | 0x00000001
383043 | MEM_FREE | 1 | 0 | 0x00000001
383097 | MEM_FREE | 1 | 0 | 0x00000001
383123 | MEM_FREE | 1 | 0 | 0x00000001
383148 | MEM_FREE | 1 | 0 | 0x00000001
386006 | JOB_SUBMIT | 1 | 0 | 0x00000003
386383 | STEP_START | 1 | 0 | -
403037 | STEP_END | 1 | 0 | 16594us
406536 | BUDGET_EXCEED | 1 | 0 | 0x000040D2
407014 | STEP_START | 1 | 1 | -
411306 | STEP_END | 1 | 1 | 4285us
413861 | BUDGET_EXCEED | 1 | 1 | 0x000010BD
413922 | STEP_START | 1 | 2 | -
429610 | STEP_END | 1 | 2 | 15680us
432159 | BUDGET_EXCEED | 1 | 2 | 0x00003D40
435094 | JOB_COMPLETE | 1 | 0 | -
448396 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
451383 | MEM_ALLOC | 2 | 1 | 0x00000001
453920 | MEM_ALLOC | 2 | 1 | 0x00000001
459541 | MEM_EXCEED | 2 | 0 | 0x0000000C
461968 | STATE_CHANGE | 2 | 0 | 0x00000001
464966 | MEM_FREE | 2 | 1 | 0x00000001
465008 | MEM_FREE | 2 | 1 | 0x00000001
467760 | JOB_SUBMIT | 2 | 0 | 0x00000002
467770 | STEP_START | 2 | 0 | -
483901 | STEP_END | 2 | 0 | 16116us
487074 | BUDGET_EXCEED | 2 | 0 | 0x00003EF4
487090 | STEP_START | 2 | 1 | -
503920 | STEP_END | 2 | 1 | 16817us
506453 | BUDGET_EXCEED | 2 | 1 | 0x000041B1
508984 | JOB_COMPLETE | 2 | 0 | -
525917 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
531158 | JOB_SUBMIT | 3 | 0 | 0x00000003
531169 | STEP_START | 3 | 0 | -
545376 | STEP_END | 3 | 0 | 14198us
545560 | STEP_START | 3 | 1 | -
560721 | STEP_END | 3 | 1 | 15153us
560744 | STEP_START | 3 | 2 | -
576272 | STEP_END | 3 | 2 | 15520us
578636 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3470us (Server=2472161620us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 14582us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4198us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5240us (Server=2472169078us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15261us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 34041us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6521us (Server=2472183893us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 17632us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5992us (Server=2472189295us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16018us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 33650us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5980us (Server=2472200966us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4930us (Server=2472205253us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5144us (Server=2472209545us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 47074us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1551 | BOOT | 0 | 0 | -
8766 | BOOT | 0 | 0 | 0x00007AB4
11869 | BOOT | 0 | 0 | 0x0000C0DE
304585 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
318451 | UNKNOWN | 100 | 8 | 0x00001388
326046 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
336375 | UNKNOWN | 100 | 1 | 0x00000008
348997 | CONTRACT_APPLY | 1 | 0 | 0x00001388
352558 | MEM_ALLOC | 1 | 0 | 0x00000001
355198 | MEM_ALLOC | 1 | 0 | 0x00000001
357651 | MEM_ALLOC | 1 | 0 | 0x00000001
360121 | MEM_ALLOC | 1 | 0 | 0x00000001
365468 | MEM_EXCEED | 1 | 0 | 0x00000014
368364 | STATE_CHANGE | 1 | 0 | 0x00000001
374136 | MEM_FREE | 1 | 0 | 0x00000001
374190 | MEM_FREE | 1 | 0 | 0x00000001
374214 | MEM_FREE | 1 | 0 | 0x00000001
374238 | MEM_FREE | 1 | 0 | 0x00000001
377252 | JOB_SUBMIT | 1 | 0 | 0x00000003
377630 | STEP_START | 1 | 0 | -
392268 | STEP_END | 1 | 0 | 14582us
395561 | BUDGET_EXCEED | 1 | 0 | 0x000038F6
396084 | STEP_START | 1 | 1 | -
400289 | STEP_END | 1 | 1 | 4198us
402819 | BUDGET_EXCEED | 1 | 1 | 0x00001066
402870 | STEP_START | 1 | 2 | -
418139 | STEP_END | 1 | 2 | 15261us
420794 | BUDGET_EXCEED | 1 | 2 | 0x00003B9D
423527 | JOB_COMPLETE | 1 | 0 | -
436933 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
439541 | MEM_ALLOC | 2 | 1 | 0x00000001
442031 | MEM_ALLOC | 2 | 1 | 0x00000001
446993 | MEM_EXCEED | 2 | 0 | 0x0000000C
449387 | STATE_CHANGE | 2 | 0 | 0x00000001
452325 | MEM_FREE | 2 | 1 | 0x00000001
452353 | MEM_FREE | 2 | 1 | 0x00000001
454895 | JOB_SUBMIT | 2 | 0 | 0x00000002
454904 | STEP_START | 2 | 0 | -
472543 | STEP_END | 2 | 0 | 17632us
475147 | BUDGET_EXCEED | 2 | 0 | 0x000044E0
475161 | STEP_START | 2 | 1 | -
491186 | STEP_END | 2 | 1 | 16018us
493765 | BUDGET_EXCEED | 2 | 1 | 0x00003E92
496272 | JOB_COMPLETE | 2 | 0 | -
511881 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
516961 | JOB_SUBMIT | 3 | 0 | 0x00000003
516970 | STEP_START | 3 | 0 | -
533395 | STEP_END | 3 | 0 | 16418us
533543 | STEP_START | 3 | 1 | -
548766 | STEP_END | 3 | 1 | 15216us
548786 | STEP_START | 3 | 2 | -
564233 | STEP_END | 3 | 2 | 15440us
566847 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5288us (Server=2472602700us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16382us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4191us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5722us (Server=2472610260us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15846us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 36419us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5664us (Server=2472625118us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16088us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6505us (Server=2472630481us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16879us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 32967us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5957us (Server=2472642224us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3564us (Server=2472646491us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3752us (Server=2472650784us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 46737us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1226 | BOOT | 0 | 0 | -
8212 | BOOT | 0 | 0 | 0x00007AB4
11483 | BOOT | 0 | 0 | 0x0000C0DE
307038 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
321399 | UNKNOWN | 100 | 8 | 0x00001388
329538 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
339902 | UNKNOWN | 100 | 1 | 0x00000008
353321 | CONTRACT_APPLY | 1 | 0 | 0x00001388
356742 | MEM_ALLOC | 1 | 0 | 0x00000001
359352 | MEM_ALLOC | 1 | 0 | 0x00000001
361923 | MEM_ALLOC | 1 | 0 | 0x00000001
364489 | MEM_ALLOC | 1 | 0 | 0x00000001
369710 | MEM_EXCEED | 1 | 0 | 0x00000014
372794 | STATE_CHANGE | 1 | 0 | 0x00000001
378847 | MEM_FREE | 1 | 0 | 0x00000001
378902 | MEM_FREE | 1 | 0 | 0x00000001
378927 | MEM_FREE | 1 | 0 | 0x00000001
378951 | MEM_FREE | 1 | 0 | 0x00000001
381702 | JOB_SUBMIT | 1 | 0 | 0x00000003
382070 | STEP_START | 1 | 0 | -
398510 | STEP_END | 1 | 0 | 16382us
402011 | BUDGET_EXCEED | 1 | 0 | 0x00003FFE
402535 | STEP_START | 1 | 1 | -
406733 | STEP_END | 1 | 1 | 4191us
409348 | BUDGET_EXCEED | 1 | 1 | 0x0000105F
409412 | STEP_START | 1 | 2 | -
425266 | STEP_END | 1 | 2 | 15846us
427773 | BUDGET_EXCEED | 1 | 2 | 0x00003DE6
430527 | JOB_COMPLETE | 1 | 0 | -
443776 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
446758 | MEM_ALLOC | 2 | 1 | 0x00000001
449400 | MEM_ALLOC | 2 | 1 | 0x00000001
454424 | MEM_EXCEED | 2 | 0 | 0x0000000C
456820 | STATE_CHANGE | 2 | 0 | 0x00000001
459700 | MEM_FREE | 2 | 1 | 0x00000001
459728 | MEM_FREE | 2 | 1 | 0x00000001
462554 | JOB_SUBMIT | 2 | 0 | 0x00000002
462572 | STEP_START | 2 | 0 | -
478667 | STEP_END | 2 | 0 | 16088us
481234 | BUDGET_EXCEED | 2 | 0 | 0x00003ED8
481249 | STEP_START | 2 | 1 | -
498138 | STEP_END | 2 | 1 | 16879us
500655 | BUDGET_EXCEED | 2 | 1 | 0x000041EF
502961 | JOB_COMPLETE | 2 | 0 | -
518520 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
524164 | JOB_SUBMIT | 3 | 0 | 0x00000003
524175 | STEP_START | 3 | 0 | -
541618 | STEP_END | 3 | 0 | 17432us
541799 | STEP_START | 3 | 1 | -
556885 | STEP_END | 3 | 1 | 15079us
556906 | STEP_START | 3 | 2 | -
571139 | STEP_END | 3 | 2 | 14226us
573535 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001B
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6684us (Server=2473047212us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 18052us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4704us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4305us (Server=2473054674us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 14863us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 37619us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5623us (Server=2473069667us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16226us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6100us (Server=2473075144us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16809us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 33035us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4709us (Server=2473086849us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4668us (Server=2473091149us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3977us (Server=2473095436us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 46184us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1310 | BOOT | 0 | 0 | -
8599 | BOOT | 0 | 0 | 0x00007AB4
11548 | BOOT | 0 | 0 | 0x0000C0DE
322022 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
335811 | UNKNOWN | 100 | 8 | 0x00001388
343456 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
354621 | UNKNOWN | 100 | 1 | 0x00000008
367726 | CONTRACT_APPLY | 1 | 0 | 0x00001388
370695 | MEM_ALLOC | 1 | 0 | 0x00000001
373248 | MEM_ALLOC | 1 | 0 | 0x00000001
376018 | MEM_ALLOC | 1 | 0 | 0x00000001
378719 | MEM_ALLOC | 1 | 0 | 0x00000001
383815 | MEM_EXCEED | 1 | 0 | 0x00000014
386713 | STATE_CHANGE | 1 | 0 | 0x00000001
393093 | MEM_FREE | 1 | 0 | 0x00000001
393148 | MEM_FREE | 1 | 0 | 0x00000001
393173 | MEM_FREE | 1 | 0 | 0x00000001
393198 | MEM_FREE | 1 | 0 | 0x00000001
395963 | JOB_SUBMIT | 1 | 0 | 0x00000003
396357 | STEP_START | 1 | 0 | -
414467 | STEP_END | 1 | 0 | 18052us
417557 | BUDGET_EXCEED | 1 | 0 | 0x00004684
418034 | STEP_START | 1 | 1 | -
422745 | STEP_END | 1 | 1 | 4704us
425507 | BUDGET_EXCEED | 1 | 1 | 0x00001260
425570 | STEP_START | 1 | 2 | -
440442 | STEP_END | 1 | 2 | 14863us
443015 | BUDGET_EXCEED | 1 | 2 | 0x00003A0F
445588 | JOB_COMPLETE | 1 | 0 | -
459579 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
462246 | MEM_ALLOC | 2 | 1 | 0x00000001
464865 | MEM_ALLOC | 2 | 1 | 0x00000001
470256 | MEM_EXCEED | 2 | 0 | 0x0000000C
472719 | STATE_CHANGE | 2 | 0 | 0x00000001
475383 | MEM_FREE | 2 | 1 | 0x00000001
475410 | MEM_FREE | 2 | 1 | 0x00000001
478046 | JOB_SUBMIT | 2 | 0 | 0x00000002
478055 | STEP_START | 2 | 0 | -
494289 | STEP_END | 2 | 0 | 16226us
497267 | BUDGET_EXCEED | 2 | 0 | 0x00003F62
497298 | STEP_START | 2 | 1 | -
514114 | STEP_END | 2 | 1 | 16809us
516791 | BUDGET_EXCEED | 2 | 1 | 0x000041A9
519180 | JOB_COMPLETE | 2 | 0 | -
535325 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
540650 | JOB_SUBMIT | 3 | 0 | 0x00000003
540665 | STEP_START | 3 | 0 | -
556245 | STEP_END | 3 | 0 | 15569us
556461 | STEP_START | 3 | 1 | -
571946 | STEP_END | 3 | 1 | 15477us
571968 | STEP_START | 3 | 2 | -
587113 | STEP_END | 3 | 2 | 15138us
589549 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6004us (Server=2473525338us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 19240us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4972us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5694us (Server=2473533930us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 17501us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 41713us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3052us (Server=2473548950us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 13421us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5875us (Server=2473554311us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16613us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 30034us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4730us (Server=2473566079us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4754us (Server=2473570434us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5124us (Server=2473574788us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 47996us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1224 | BOOT | 0 | 0 | -
9047 | BOOT | 0 | 0 | 0x00007AB4
12086 | BOOT | 0 | 0 | 0x0000C0DE
331930 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
346007 | UNKNOWN | 100 | 8 | 0x00001388
355126 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
366507 | UNKNOWN | 100 | 1 | 0x00000008
380386 | CONTRACT_APPLY | 1 | 0 | 0x00001388
383745 | MEM_ALLOC | 1 | 0 | 0x00000001
386548 | MEM_ALLOC | 1 | 0 | 0x00000001
389114 | MEM_ALLOC | 1 | 0 | 0x00000001
391802 | MEM_ALLOC | 1 | 0 | 0x00000001
397878 | MEM_EXCEED | 1 | 0 | 0x00000014
400806 | STATE_CHANGE | 1 | 0 | 0x00000001
406934 | MEM_FREE | 1 | 0 | 0x00000001
406994 | MEM_FREE | 1 | 0 | 0x00000001
407019 | MEM_FREE | 1 | 0 | 0x00000001
407043 | MEM_FREE | 1 | 0 | 0x00000001
410233 | JOB_SUBMIT | 1 | 0 | 0x00000003
410678 | STEP_START | 1 | 0 | -
429960 | STEP_END | 1 | 0 | 19240us
433605 | BUDGET_EXCEED | 1 | 0 | 0x00004B28
434088 | STEP_START | 1 | 1 | -
439071 | STEP_END | 1 | 1 | 4972us
442025 | BUDGET_EXCEED | 1 | 1 | 0x0000136C
442104 | STEP_START | 1 | 2 | -
459614 | STEP_END | 1 | 2 | 17501us
462578 | BUDGET_EXCEED | 1 | 2 | 0x0000445D
465396 | JOB_COMPLETE | 1 | 0 | -
479675 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
482369 | MEM_ALLOC | 2 | 1 | 0x00000001
485392 | MEM_ALLOC | 2 | 1 | 0x00000001
490495 | MEM_EXCEED | 2 | 0 | 0x0000000C
492946 | STATE_CHANGE | 2 | 0 | 0x00000001
495733 | MEM_FREE | 2 | 1 | 0x00000001
495761 | MEM_FREE | 2 | 1 | 0x00000001
498472 | JOB_SUBMIT | 2 | 0 | 0x00000002
498483 | STEP_START | 2 | 0 | -
511912 | STEP_END | 2 | 0 | 13421us
515044 | BUDGET_EXCEED | 2 | 0 | 0x0000346D
515060 | STEP_START | 2 | 1 | -
531680 | STEP_END | 2 | 1 | 16613us
534433 | BUDGET_EXCEED | 2 | 1 | 0x000040E5
536834 | JOB_COMPLETE | 2 | 0 | -
552815 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
558190 | JOB_SUBMIT | 3 | 0 | 0x00000003
558202 | STEP_START | 3 | 0 | -
573823 | STEP_END | 3 | 0 | 15613us
574041 | STEP_START | 3 | 1 | -
589775 | STEP_END | 3 | 1 | 15727us
589799 | STEP_START | 3 | 2 | -
606465 | STEP_END | 3 | 2 | 16656us
608949 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4602us (Server=2473962627us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15832us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4198us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5844us (Server=2473970193us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15902us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 35932us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3193us (Server=2473984105us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 13299us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6699us (Server=2473989491us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16861us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 30160us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6737us (Server=2474001351us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4882us (Server=2474005590us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5436us (Server=2474009883us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 47850us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1218 | BOOT | 0 | 0 | -
8119 | BOOT | 0 | 0 | 0x00007AB4
11032 | BOOT | 0 | 0 | 0x0000C0DE
316430 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
330233 | UNKNOWN | 100 | 8 | 0x00001388
338077 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
348426 | UNKNOWN | 100 | 1 | 0x00000008
361722 | CONTRACT_APPLY | 1 | 0 | 0x00001388
364797 | MEM_ALLOC | 1 | 0 | 0x00000001
367417 | MEM_ALLOC | 1 | 0 | 0x00000001
370131 | MEM_ALLOC | 1 | 0 | 0x00000001
372696 | MEM_ALLOC | 1 | 0 | 0x00000001
377789 | MEM_EXCEED | 1 | 0 | 0x00000014
380752 | STATE_CHANGE | 1 | 0 | 0x00000001
386880 | MEM_FREE | 1 | 0 | 0x00000001
386935 | MEM_FREE | 1 | 0 | 0x00000001
386959 | MEM_FREE | 1 | 0 | 0x00000001
386984 | MEM_FREE | 1 | 0 | 0x00000001
389760 | JOB_SUBMIT | 1 | 0 | 0x00000003
390129 | STEP_START | 1 | 0 | -
406019 | STEP_END | 1 | 0 | 15832us
409208 | BUDGET_EXCEED | 1 | 0 | 0x00003DD8
409674 | STEP_START | 1 | 1 | -
413878 | STEP_END | 1 | 1 | 4198us
416458 | BUDGET_EXCEED | 1 | 1 | 0x00001066
416514 | STEP_START | 1 | 2 | -
432424 | STEP_END | 1 | 2 | 15902us
435028 | BUDGET_EXCEED | 1 | 2 | 0x00003E1E
437600 | JOB_COMPLETE | 1 | 0 | -
450892 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
453557 | MEM_ALLOC | 2 | 1 | 0x00000001
456096 | MEM_ALLOC | 2 | 1 | 0x00000001
461208 | MEM_EXCEED | 2 | 0 | 0x0000000C
463662 | STATE_CHANGE | 2 | 0 | 0x00000001
466469 | MEM_FREE | 2 | 1 | 0x00000001
466500 | MEM_FREE | 2 | 1 | 0x00000001
469079 | JOB_SUBMIT | 2 | 0 | 0x00000002
469088 | STEP_START | 2 | 0 | -
482395 | STEP_END | 2 | 0 | 13299us
485018 | BUDGET_EXCEED | 2 | 0 | 0x000033F3
485035 | STEP_START | 2 | 1 | -
501904 | STEP_END | 2 | 1 | 16861us
504503 | BUDGET_EXCEED | 2 | 1 | 0x000041DD
506880 | JOB_COMPLETE | 2 | 0 | -
522292 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
527357 | JOB_SUBMIT | 3 | 0 | 0x00000003
527368 | STEP_START | 3 | 0 | -
544515 | STEP_END | 3 | 0 | 17140us
544699 | STEP_START | 3 | 1 | -
559903 | STEP_END | 3 | 1 | 15197us
559925 | STEP_START | 3 | 2 | -
575444 | STEP_END | 3 | 2 | 15513us
577873 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001B
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5825us (Server=2474405911us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 17635us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4310us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4257us (Server=2474413507us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15137us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 37082us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5821us (Server=2474428414us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15965us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5499us (Server=2474433746us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16191us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 32156us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5481us (Server=2474445496us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5355us (Server=2474449841us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5292us (Server=2474454227us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 46731us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1184 | BOOT | 0 | 0 | -
8353 | BOOT | 0 | 0 | 0x00007AB4
11853 | BOOT | 0 | 0 | 0x0000C0DE
325147 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
339294 | UNKNOWN | 100 | 8 | 0x00001388
347373 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
358794 | UNKNOWN | 100 | 1 | 0x00000008
371906 | CONTRACT_APPLY | 1 | 0 | 0x00001388
374924 | MEM_ALLOC | 1 | 0 | 0x00000001
377463 | MEM_ALLOC | 1 | 0 | 0x00000001
380124 | MEM_ALLOC | 1 | 0 | 0x00000001
382683 | MEM_ALLOC | 1 | 0 | 0x00000001
388366 | MEM_EXCEED | 1 | 0 | 0x00000014
391200 | STATE_CHANGE | 1 | 0 | 0x00000001
397764 | MEM_FREE | 1 | 0 | 0x00000001
397885 | MEM_FREE | 1 | 0 | 0x00000001
397927 | MEM_FREE | 1 | 0 | 0x00000001
397963 | MEM_FREE | 1 | 0 | 0x00000001
400748 | JOB_SUBMIT | 1 | 0 | 0x00000003
401118 | STEP_START | 1 | 0 | -
418816 | STEP_END | 1 | 0 | 17635us
422041 | BUDGET_EXCEED | 1 | 0 | 0x000044E3
422506 | STEP_START | 1 | 1 | -
426823 | STEP_END | 1 | 1 | 4310us
430035 | BUDGET_EXCEED | 1 | 1 | 0x000010D6
430116 | STEP_START | 1 | 2 | -
445263 | STEP_END | 1 | 2 | 15137us
447877 | BUDGET_EXCEED | 1 | 2 | 0x00003B21
450391 | JOB_COMPLETE | 1 | 0 | -
464340 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
466917 | MEM_ALLOC | 2 | 1 | 0x00000001
469402 | MEM_ALLOC | 2 | 1 | 0x00000001
474989 | MEM_EXCEED | 2 | 0 | 0x0000000C
477448 | STATE_CHANGE | 2 | 0 | 0x00000001
480135 | MEM_FREE | 2 | 1 | 0x00000001
480162 | MEM_FREE | 2 | 1 | 0x00000001
482696 | JOB_SUBMIT | 2 | 0 | 0x00000002
482705 | STEP_START | 2 | 0 | -
498677 | STEP_END | 2 | 0 | 15965us
501226 | BUDGET_EXCEED | 2 | 0 | 0x00003E5D
501238 | STEP_START | 2 | 1 | -
517437 | STEP_END | 2 | 1 | 16191us
520577 | BUDGET_EXCEED | 2 | 1 | 0x00003F3F
522957 | JOB_COMPLETE | 2 | 0 | -
539050 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
544114 | JOB_SUBMIT | 3 | 0 | 0x00000003
544123 | STEP_START | 3 | 0 | -
559708 | STEP_END | 3 | 0 | 15579us
559895 | STEP_START | 3 | 1 | -
575444 | STEP_END | 3 | 1 | 15542us
575463 | STEP_START | 3 | 2 | -
591079 | STEP_END | 3 | 2 | 15610us
594070 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4370us (Server=2474846558us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15984us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4208us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5402us (Server=2474854091us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15591us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 35783us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5600us (Server=2474872236us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16985us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5887us (Server=2474877525us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 15950us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 32935us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4643us (Server=2474889274us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4373us (Server=2474893535us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5015us (Server=2474897854us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 46064us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1205 | BOOT | 0 | 0 | -
8669 | BOOT | 0 | 0 | 0x00007AB4
12258 | BOOT | 0 | 0 | 0x0000C0DE
323907 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
337812 | UNKNOWN | 100 | 8 | 0x00001388
345875 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
357075 | UNKNOWN | 100 | 1 | 0x00000008
370156 | CONTRACT_APPLY | 1 | 0 | 0x00001388
373224 | MEM_ALLOC | 1 | 0 | 0x00000001
375738 | MEM_ALLOC | 1 | 0 | 0x00000001
378181 | MEM_ALLOC | 1 | 0 | 0x00000001
380830 | MEM_ALLOC | 1 | 0 | 0x00000001
385968 | MEM_EXCEED | 1 | 0 | 0x00000014
389346 | STATE_CHANGE | 1 | 0 | 0x00000001
395296 | MEM_FREE | 1 | 0 | 0x00000001
395381 | MEM_FREE | 1 | 0 | 0x00000001
395425 | MEM_FREE | 1 | 0 | 0x00000001
395460 | MEM_FREE | 1 | 0 | 0x00000001
398271 | JOB_SUBMIT | 1 | 0 | 0x00000003
398639 | STEP_START | 1 | 0 | -
414685 | STEP_END | 1 | 0 | 15984us
418353 | BUDGET_EXCEED | 1 | 0 | 0x00003E70
418844 | STEP_START | 1 | 1 | -
423058 | STEP_END | 1 | 1 | 4208us
425815 | BUDGET_EXCEED | 1 | 1 | 0x00001070
425880 | STEP_START | 1 | 2 | -
441479 | STEP_END | 1 | 2 | 15591us
444679 | BUDGET_EXCEED | 1 | 2 | 0x00003CE7
447254 | JOB_COMPLETE | 1 | 0 | -
463435 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
467827 | MEM_ALLOC | 2 | 1 | 0x00000001
471922 | MEM_ALLOC | 2 | 1 | 0x00000001
480040 | MEM_EXCEED | 2 | 0 | 0x0000000C
483662 | STATE_CHANGE | 2 | 0 | 0x00000001
487950 | MEM_FREE | 2 | 1 | 0x00000001
487987 | MEM_FREE | 2 | 1 | 0x00000001
490557 | JOB_SUBMIT | 2 | 0 | 0x00000002
490567 | STEP_START | 2 | 0 | -
507564 | STEP_END | 2 | 0 | 16985us
510127 | BUDGET_EXCEED | 2 | 0 | 0x00004259
510140 | STEP_START | 2 | 1 | -
526098 | STEP_END | 2 | 1 | 15950us
528646 | BUDGET_EXCEED | 2 | 1 | 0x00003E4E
531277 | JOB_COMPLETE | 2 | 0 | -
547773 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
552860 | JOB_SUBMIT | 3 | 0 | 0x00000003
552869 | STEP_START | 3 | 0 | -
568342 | STEP_END | 3 | 0 | 15463us
568518 | STEP_START | 3 | 1 | -
583597 | STEP_END | 3 | 1 | 15071us
583619 | STEP_START | 3 | 2 | -
599157 | STEP_END | 3 | 2 | 15530us
601507 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000001B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4133us (Server=2475296598us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15958us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4147us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4178us (Server=2475304203us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 14991us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 35096us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6806us (Server=2475319224us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16663us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6145us (Server=2475324651us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16210us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 32873us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6621us (Server=2475336488us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5143us (Server=2475340787us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5328us (Server=2475345079us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 46909us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1187 | BOOT | 0 | 0 | -
9065 | BOOT | 0 | 0 | 0x00007AB4
12017 | BOOT | 0 | 0 | 0x0000C0DE
322683 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
336445 | UNKNOWN | 100 | 8 | 0x00001388
343887 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
355139 | UNKNOWN | 100 | 1 | 0x00000008
368283 | CONTRACT_APPLY | 1 | 0 | 0x00001388
371327 | MEM_ALLOC | 1 | 0 | 0x00000001
373847 | MEM_ALLOC | 1 | 0 | 0x00000001
376318 | MEM_ALLOC | 1 | 0 | 0x00000001
378903 | MEM_ALLOC | 1 | 0 | 0x00000001
384630 | MEM_EXCEED | 1 | 0 | 0x00000014
387520 | STATE_CHANGE | 1 | 0 | 0x00000001
393370 | MEM_FREE | 1 | 0 | 0x00000001
393425 | MEM_FREE | 1 | 0 | 0x00000001
393459 | MEM_FREE | 1 | 0 | 0x00000001
393497 | MEM_FREE | 1 | 0 | 0x00000001
396963 | JOB_SUBMIT | 1 | 0 | 0x00000003
397394 | STEP_START | 1 | 0 | -
413418 | STEP_END | 1 | 0 | 15958us
416877 | BUDGET_EXCEED | 1 | 0 | 0x00003E56
417344 | STEP_START | 1 | 1 | -
421497 | STEP_END | 1 | 1 | 4147us
424387 | BUDGET_EXCEED | 1 | 1 | 0x00001033
424454 | STEP_START | 1 | 2 | -
439453 | STEP_END | 1 | 2 | 14991us
442606 | BUDGET_EXCEED | 1 | 2 | 0x00003A8F
445176 | JOB_COMPLETE | 1 | 0 | -
458978 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
461537 | MEM_ALLOC | 2 | 1 | 0x00000001
463961 | MEM_ALLOC | 2 | 1 | 0x00000001
468916 | MEM_EXCEED | 2 | 0 | 0x0000000C
471944 | STATE_CHANGE | 2 | 0 | 0x00000001
474628 | MEM_FREE | 2 | 1 | 0x00000001
474657 | MEM_FREE | 2 | 1 | 0x00000001
477167 | JOB_SUBMIT | 2 | 0 | 0x00000002
477177 | STEP_START | 2 | 0 | -
493849 | STEP_END | 2 | 0 | 16663us
496481 | BUDGET_EXCEED | 2 | 0 | 0x00004117
496494 | STEP_START | 2 | 1 | -
512713 | STEP_END | 2 | 1 | 16210us
515777 | BUDGET_EXCEED | 2 | 1 | 0x00003F52
518274 | JOB_COMPLETE | 2 | 0 | -
534091 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
539089 | JOB_SUBMIT | 3 | 0 | 0x00000003
539099 | STEP_START | 3 | 0 | -
555641 | STEP_END | 3 | 0 | 16522us
555829 | STEP_START | 3 | 1 | -
571008 | STEP_END | 3 | 1 | 15172us
571028 | STEP_START | 3 | 2 | -
586249 | STEP_END | 3 | 2 | 15215us
588651 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3166us (Server=2475732687us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 14361us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4232us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5832us (Server=2475740253us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 16123us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 34716us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3213us (Server=2475754235us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 13446us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6206us (Server=2475759527us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16912us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 30358us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5912us (Server=2475771409us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4824us (Server=2475775731us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5200us (Server=2475780061us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 47253us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1196 | BOOT | 0 | 0 | -
8019 | BOOT | 0 | 0 | 0x00007AB4
11271 | BOOT | 0 | 0 | 0x0000C0DE
311585 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
325660 | UNKNOWN | 100 | 8 | 0x00001388
333321 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
343466 | UNKNOWN | 100 | 1 | 0x00000008
356890 | CONTRACT_APPLY | 1 | 0 | 0x00001388
359899 | MEM_ALLOC | 1 | 0 | 0x00000001
362458 | MEM_ALLOC | 1 | 0 | 0x00000001
364946 | MEM_ALLOC | 1 | 0 | 0x00000001
367443 | MEM_ALLOC | 1 | 0 | 0x00000001
372578 | MEM_EXCEED | 1 | 0 | 0x00000014
375380 | STATE_CHANGE | 1 | 0 | 0x00000001
381337 | MEM_FREE | 1 | 0 | 0x00000001
381391 | MEM_FREE | 1 | 0 | 0x00000001
381416 | MEM_FREE | 1 | 0 | 0x00000001
381439 | MEM_FREE | 1 | 0 | 0x00000001
384179 | JOB_SUBMIT | 1 | 0 | 0x00000003
384573 | STEP_START | 1 | 0 | -
398987 | STEP_END | 1 | 0 | 14361us
402191 | BUDGET_EXCEED | 1 | 0 | 0x00003819
402660 | STEP_START | 1 | 1 | -
406899 | STEP_END | 1 | 1 | 4232us
409500 | BUDGET_EXCEED | 1 | 1 | 0x00001088
409553 | STEP_START | 1 | 2 | -
425684 | STEP_END | 1 | 2 | 16123us
428260 | BUDGET_EXCEED | 1 | 2 | 0x00003EFB
430839 | JOB_COMPLETE | 1 | 0 | -
444184 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
446908 | MEM_ALLOC | 2 | 1 | 0x00000001
449469 | MEM_ALLOC | 2 | 1 | 0x00000001
454475 | MEM_EXCEED | 2 | 0 | 0x0000000C
456916 | STATE_CHANGE | 2 | 0 | 0x00000001
459733 | MEM_FREE | 2 | 1 | 0x00000001
459759 | MEM_FREE | 2 | 1 | 0x00000001
462354 | JOB_SUBMIT | 2 | 0 | 0x00000002
462364 | STEP_START | 2 | 0 | -
475818 | STEP_END | 2 | 0 | 13446us
478466 | BUDGET_EXCEED | 2 | 0 | 0x00003486
478479 | STEP_START | 2 | 1 | -
495405 | STEP_END | 2 | 1 | 16912us
498047 | BUDGET_EXCEED | 2 | 1 | 0x00004210
500459 | JOB_COMPLETE | 2 | 0 | -
516288 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
521504 | JOB_SUBMIT | 3 | 0 | 0x00000003
521516 | STEP_START | 3 | 0 | -
537966 | STEP_END | 3 | 0 | 16440us
538220 | STEP_START | 3 | 1 | -
553379 | STEP_END | 3 | 1 | 15148us
553406 | STEP_START | 3 | 2 | -
569082 | STEP_END | 3 | 2 | 15665us
571523 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3807us (Server=2476208768us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 16159us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4188us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4659us (Server=2476216278us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 15012us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 35359us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4836us (Server=2476231274us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15699us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6280us (Server=2476236634us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16397us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 32096us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=3992us (Server=2476248315us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4866us (Server=2476252633us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5224us (Server=2476256949us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 45502us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1255 | BOOT | 0 | 0 | -
9059 | BOOT | 0 | 0 | 0x00007AB4
12005 | BOOT | 0 | 0 | 0x0000C0DE
320307 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
334332 | UNKNOWN | 100 | 8 | 0x00001388
342749 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
353971 | UNKNOWN | 100 | 1 | 0x00000008
367067 | CONTRACT_APPLY | 1 | 0 | 0x00001388
370371 | MEM_ALLOC | 1 | 0 | 0x00000001
372965 | MEM_ALLOC | 1 | 0 | 0x00000001
375477 | MEM_ALLOC | 1 | 0 | 0x00000001
377991 | MEM_ALLOC | 1 | 0 | 0x00000001
383868 | MEM_EXCEED | 1 | 0 | 0x00000014
386840 | STATE_CHANGE | 1 | 0 | 0x00000001
392773 | MEM_FREE | 1 | 0 | 0x00000001
392826 | MEM_FREE | 1 | 0 | 0x00000001
392851 | MEM_FREE | 1 | 0 | 0x00000001
392875 | MEM_FREE | 1 | 0 | 0x00000001
395870 | JOB_SUBMIT | 1 | 0 | 0x00000003
396413 | STEP_START | 1 | 0 | -
412614 | STEP_END | 1 | 0 | 16159us
415797 | BUDGET_EXCEED | 1 | 0 | 0x00003F1F
416263 | STEP_START | 1 | 1 | -
420458 | STEP_END | 1 | 1 | 4188us
423146 | BUDGET_EXCEED | 1 | 1 | 0x0000105C
423201 | STEP_START | 1 | 2 | -
438221 | STEP_END | 1 | 2 | 15012us
441074 | BUDGET_EXCEED | 1 | 2 | 0x00003AA4
444216 | JOB_COMPLETE | 1 | 0 | -
458427 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
461124 | MEM_ALLOC | 2 | 1 | 0x00000001
463616 | MEM_ALLOC | 2 | 1 | 0x00000001
468592 | MEM_EXCEED | 2 | 0 | 0x0000000C
471368 | STATE_CHANGE | 2 | 0 | 0x00000001
474578 | MEM_FREE | 2 | 1 | 0x00000001
474611 | MEM_FREE | 2 | 1 | 0x00000001
477198 | JOB_SUBMIT | 2 | 0 | 0x00000002
477208 | STEP_START | 2 | 0 | -
492918 | STEP_END | 2 | 0 | 15699us
495755 | BUDGET_EXCEED | 2 | 0 | 0x00003D53
495774 | STEP_START | 2 | 1 | -
512177 | STEP_END | 2 | 1 | 16397us
514862 | BUDGET_EXCEED | 2 | 1 | 0x0000400D
517942 | JOB_COMPLETE | 2 | 0 | -
534358 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
539505 | JOB_SUBMIT | 3 | 0 | 0x00000003
539518 | STEP_START | 3 | 0 | -
554315 | STEP_END | 3 | 0 | 14787us
554501 | STEP_START | 3 | 1 | -
569872 | STEP_END | 3 | 1 | 15363us
569894 | STEP_START | 3 | 2 | -
585254 | STEP_END | 3 | 2 | 15352us
587634 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
[test] Job memory metrics:
  total_memory_kb: 12
  peak_memory_kb: 8
  pinned_memory_kb: 4
[contracts] applying contract for job 100
[contracts] priority=HIGH, node=1, cpu_budget=50000us, mem_budget=64KB
[test] Admission check (generous budget):
[admit] checking job 100 against contract for job 100
[admit] job peak memory: 8KB, contract budget: 64KB
[admit] estimated CPU: 5000us, budget: 50000us
[admit] job 100 ADMITTED
  result: OK
[contracts] applying contract for job 101
[contracts] priority=LOW, node=1, cpu_budget=1000us, mem_budget=4KB
[test] Admission check (tight budget):
[admit] checking job 100 against contract for job 101
[admit] job peak memory: 8KB, contract budget: 4KB
[admit] REJECTED: memory budget exceeded
  result: REJECT_MEMORY

--- Demo 1: REALTIME priority job (node 0) ---
[contracts] applying contract for job 1
[contracts] priority=REALTIME, node=0, cpu_budget=5000us, mem_budget=16KB
[test] allocating 5 pages via contract...
  page 0 @ node 0
  page 1 @ node 0
  page 2 @ node 0
  page 3 @ node 0
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 1 state: OK -> WARNED
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=16/16KB
[test] freeing pages...
[sched] run_job begin (budget: 5000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=6543us (Server=2476649167us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 17501us (limit: 1666us)
[sched] simulating non-compute step 1
[sched] BUDGET EXCEED: step 1 took 4738us (limit: 1666us)
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4370us (Server=2476656641us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 2 took 14956us (limit: 1666us)
[sched] no ready steps left
[sched] run_job end - 3 steps, 37195us CPU, 3 violations

--- Demo 2: LOW priority job (node 1) ---
[contracts] applying contract for job 2
[contracts] priority=LOW, node=1, cpu_budget=3000us, mem_budget=8KB
[test] allocating 3 pages via LOW contract...
  page 0 @ node 1
  page 1 @ node 1
[contracts] allocation denied: BUDGET EXCEEDED
[contracts] job 2 state: OK -> WARNED
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=8/8KB
[sched] run_job begin (budget: 3000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4502us (Server=2476671574us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 0 took 15437us (limit: 1500us)
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=5984us (Server=2476676953us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] BUDGET EXCEED: step 1 took 16904us (limit: 1500us)
[sched] no ready steps left
[sched] run_job end - 2 steps, 32341us CPU, 2 violations

--- Demo 3: Distributed Pipeline (Host Acceleration) ---
[demo] Creating multi-stage neural network job...
[contracts] applying contract for job 3
[contracts] priority=HIGH, node=1, cpu_budget=100000us, mem_budget=1024KB
[demo] Submitting pipeline job to scheduler...
[sched] run_job begin (budget: 100000us)
[sched] Offloading COMPUTE step 0 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4125us (Server=2476688709us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 1 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4561us (Server=2476693036us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] Offloading COMPUTE step 2 to Bridge...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[sched] Step complete. Result: 0x00000000
[sched] Latency Breakdown: Total=4598us (Server=2476697361us, Transport=0us)
[sched] Remote error status: 0x00008001
[sched] no ready steps left
[sched] run_job end - 3 steps, 45834us CPU, 0 violations

--- Final Contract States ---
[contracts] Job 1: state=WARNED, cpu=0/5000us, mem=0/16KB
[contracts] Job 2: state=WARNED, cpu=0/3000us, mem=0/8KB

=== FLIGHT RECORDER DUMP ===
TIME(us)     | TYPE             | JOB  | STEP | EXTRA
-------------|------------------|------|------|--------
1227 | BOOT | 0 | 0 | -
9128 | BOOT | 0 | 0 | 0x00007AB4
12070 | BOOT | 0 | 0 | 0x0000C0DE
313832 | CONTRACT_APPLY | 100 | 0 | 0x0000C350
328635 | UNKNOWN | 100 | 8 | 0x00001388
336464 | CONTRACT_APPLY | 101 | 0 | 0x000003E8
347114 | UNKNOWN | 100 | 1 | 0x00000008
360806 | CONTRACT_APPLY | 1 | 0 | 0x00001388
363734 | MEM_ALLOC | 1 | 0 | 0x00000001
366634 | MEM_ALLOC | 1 | 0 | 0x00000001
369660 | MEM_ALLOC | 1 | 0 | 0x00000001
372173 | MEM_ALLOC | 1 | 0 | 0x00000001
377121 | MEM_EXCEED | 1 | 0 | 0x00000014
379917 | STATE_CHANGE | 1 | 0 | 0x00000001
386828 | MEM_FREE | 1 | 0 | 0x00000001
386885 | MEM_FREE | 1 | 0 | 0x00000001
386910 | MEM_FREE | 1 | 0 | 0x00000001
386933 | MEM_FREE | 1 | 0 | 0x00000001
389650 | JOB_SUBMIT | 1 | 0 | 0x00000003
390023 | STEP_START | 1 | 0 | -
407605 | STEP_END | 1 | 0 | 17501us
410929 | BUDGET_EXCEED | 1 | 0 | 0x0000445D
411552 | STEP_START | 1 | 1 | -
416296 | STEP_END | 1 | 1 | 4738us
418870 | BUDGET_EXCEED | 1 | 1 | 0x00001282
418928 | STEP_START | 1 | 2 | -
433893 | STEP_END | 1 | 2 | 14956us
436449 | BUDGET_EXCEED | 1 | 2 | 0x00003A6C
438981 | JOB_COMPLETE | 1 | 0 | -
452910 | CONTRACT_APPLY | 2 | 0 | 0x00000BB8
455741 | MEM_ALLOC | 2 | 1 | 0x00000001
458900 | MEM_ALLOC | 2 | 1 | 0x00000001
463852 | MEM_EXCEED | 2 | 0 | 0x0000000C
466261 | STATE_CHANGE | 2 | 0 | 0x00000001
468928 | MEM_FREE | 2 | 1 | 0x00000001
468955 | MEM_FREE | 2 | 1 | 0x00000001
471829 | JOB_SUBMIT | 2 | 0 | 0x00000002
471846 | STEP_START | 2 | 0 | -
487298 | STEP_END | 2 | 0 | 15437us
490132 | BUDGET_EXCEED | 2 | 0 | 0x00003C4D
490155 | STEP_START | 2 | 1 | -
507067 | STEP_END | 2 | 1 | 16904us
509618 | BUDGET_EXCEED | 2 | 1 | 0x00004208
511957 | JOB_COMPLETE | 2 | 0 | -
527965 | CONTRACT_APPLY | 3 | 0 | 0x000186A0
534275 | JOB_SUBMIT | 3 | 0 | 0x00000003
534290 | STEP_START | 3 | 0 | -
549246 | STEP_END | 3 | 0 | 14945us
549464 | STEP_START | 3 | 1 | -
564886 | STEP_END | 3 | 1 | 15411us
564915 | STEP_START | 3 | 2 | -
580402 | STEP_END | 3 | 2 | 15478us
582745 | JOB_COMPLETE | 3 | 0 | -
=== END DUMP (53 events) ===


--- Interrupt System Demo ---
[demo] waiting ~500ms for timer ticks...
[demo] timer ticks elapsed: 0 (skipped sleep)

--- Round Robin Scheduler Demo ---
[kheap] initialized at 0xC0126000 size: 4194304 bytes
[sched] initializing Process Model MVP...
[sched] Idle process created. Now creating User Process...
[vmm] new user PD at phys 0x00530000 (virt 0xC0530000)
[vmm] kernel PD at phys 0x00101000 (virt 0xC0101000)
[vmm] kernel_pd[768] = 0x000001E3, new_pd[768] = 0x000001E3
SWCR3OK
SWCR3OK
[proc] created pid=1 cr3=0x00530000
SWCR3OK
SWCR3OK

--- In-Kernel Inference Demo (Neural Kernel) ---
[kern] Resetting environment...
[ipc] response: status=0x00008000 cmd=0x00000100 result=0x00000006
[kern] Response received.
[kern] Reset OK. Init Blob: 6
[kern] Starting Neural Control Loop (200 steps)...
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000007
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000008
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000009
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000A
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000B
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000C
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000D
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000E
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x0000000F
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000010
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000011
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000012
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000013
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000014
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000015
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000016
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000017
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000018
[kern] Warn: No model weights found (ID 0). Using Heuristic.
[ipc] response: status=0x00008000 cmd=0x00000101 result=0x00000019
[kern] Warn: No model weights found (ID 0). Using Heurist[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
[USER] Hello from Process 1!
ZE>PSVMHH
KM
ZENEDGE kernel booting...
AI + Edge Computing Kernel Playground

[time] initializing time subsystem
[time] using assumed 1000 MHz CPU frequency
[time] init complete
[trace] flight recorder initialized (256 event ring buffer)
[pmm] initializing physical memory manager
[pmm] mboot at 0x00009500, flags=0x0000024F
[pmm] parsing memory map...
[pmm] found 6 memory regions
[pmm] kernel: phys 0x00100000 - 0x0052C000
[pmm] NUMA node 0: PFN 256-16496 (15172 free)
[pmm] NUMA node 1: PFN 16496-32736 (16240 free)
[pmm] total memory: 130944 KB (32736 pages)
[pmm] free memory: 125648 KB (31412 pages)
[pmm] init complete
[vmm] initializing virtual memory manager
[vmm] current page directory at 0x00101000
[vmm] paging enabled, kernel mapped 128MB@0xC0000000 (PSE)
[vmm] init complete
[gdt] initializing GDT with TSS...
[gdt] GDT loaded, TSS installed
[idt] initializing IDT...
[idt] IDT loaded with 32 exceptions + 16 IRQs + syscall
[pic] remapping IRQs to vectors 32-47...
[pic] PIC initialized, all IRQs masked
[pit] configuring timer at 100 Hz
[pit] timer configured, IRQ0 unmasked
[keyboard] initialized
[kmain] enabling interrupts...
[syscall] registering syscall handler on vector 128
[pci] Scanning Bus 0...
[pci] Found 0x00008086:0x00001237 at 0:0.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007000 at 0:1.0 (Class 0x00000006)
[pci] Found 0x00008086:0x00007010 at 0:1.1 (Class 0x00000001)
[pci] Found 0x00008086:0x00007113 at 0:1.3 (Class 0x00000006)
[pci] Found 0x00001234:0x00001111 at 0:2.0 (Class 0x00000003)
[pci] Found 0x00008086:0x0000100E at 0:3.0 (Class 0x00000002)
[pci] Found 0x00001AF4:0x00001110 at 0:4.0 (Class 0x00000005)
[ivshmem] Found device at 0:4.0
[ivshmem] IRQ: 0
[ivshmem] ISR registered on vector 32
[ivshmem] Shared Memory Phys: 0xFE000000 Size: 1048576 bytes
[ivshmem] Mapped to Virt: 0xE0000000
[ipc] initializing proxy driver...
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[ipc] cmd ring at 0xE0000000
[ipc] rsp ring at 0xE0008000
[ipc] doorbell at 0xE0010000
[heap] initializing shared heap at 0xE0010100
[heap] initialized: 956KB, 15296 blocks
[ipc] Warning: Invalid IRQ, polling mode only.
[ipc] initialized mesh table
[ipc] joined mesh as Node 0

--- IPC Inference Demo ---
[test] Allocated input tensor: id=1
[test] Sending CMD_RUN_MODEL...
[test] Polling for response...
[ipc] response: status=0x00008001 cmd=0x00000010 result=0x00000000
[test] Got response! status=0x00008001 result_blob=0x00000000
[ipc] === DEBUG DUMP ===
[ipc] CMD Ring:
  Magic: 0x51DECA9E (valid)
  Head:  1
  Tail:  1
  Pending: 0 packets
[ipc] RSP Ring:
  Magic: 0x52535030 (valid)
  Head:  1
  Tail:  1
  Pending: 0 responses
[ipc] Doorbell:
  Magic: 0x444F4F52 (valid)
  CMD doorbell: 1 (writes: 1, irqs: 0)
  RSP doorbell: 1 (writes: 1, irqs: 0)
  RSP IRQ enabled: yes
  Local IRQ count: 0
[ipc] === END DUMP ===

--- Shared Heap Demo ---
[test] Allocated raw blob: id=2
[test] Allocated tensor blob: id=3
[test] Wrote 16 floats to tensor
[test] Allocated image tensor: id=4
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15234/15296 free
[heap] Memory: 3968/978944 bytes used
[heap] Blobs: 4 allocated
  [1] type=1 size=3172 blocks=51
  [2] type=0 size=128 blocks=3
  [3] type=1 size=100 blocks=3
  [4] type=1 size=228 blocks=5
[heap] === END DUMP ===
[test] Freed blob 2
[heap] === DEBUG DUMP ===
[heap] Magic: 0x48454150 (valid)
[heap] Blocks: 15237/15296 free
[heap] Memory: 3776/978944 bytes used
[heap] Blobs: 3 allocated
  [1] type=1 size=3172 blocks=51
  [4] type=1 size=228 blocks=5
  [3] type=1 size=100 blocks=3
[heap] === END DUMP ===

=== MEMORY MAP ===
REGION | BASE       | LENGTH     | TYPE
-------|------------|------------|------------
0      | 0x00000000 | 0x0009FC00 | Available
1      | 0x0009FC00 | 0x00000400 | Reserved
2      | 0x000F0000 | 0x00010000 | Reserved
3      | 0x00100000 | 0x07EE0000 | Available
4      | 0x07FE0000 | 0x00020000 | Reserved
5      | 0xFFFC0000 | 0x00040000 | Reserved

=== NUMA TOPOLOGY ===
Node 0: 60684 KB free / 64960 KB total
Node 1: 64960 KB free / 64960 KB total
=== END MAP ===

[contracts] init
[sched] init

--- Demo 0: Tensor Metadata & Admission Control ---
qemu-system-i386: terminating on signal 15 from pid 30989 (/bin/bash)
